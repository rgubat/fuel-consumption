<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Fuel</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Krub:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: Bikin
  * Template URL: https://bootstrapmade.com/bikin-free-simple-landing-page-template/
  * Updated: Mar 17 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  <style>
    .pac-container {
      z-index: 10000 !important; /* Ensure this is higher than the modal's z-index */
  }
    #map-main {
      height: 400px;
      width: 100%;
  }
  </style>
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">

      <h1 class="logo"><a href="index.html">Fuel Consumption</a></h1>
      <!-- Uncomment below if you prefer to use an image logo -->
      <!-- <a href="index.html" class="logo"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto active" href="#hero">Home</a></li>
          <li><a class="getstarted scrollto" data-bs-toggle="modal" data-bs-target="#exampleModal">Add Vehicle</a></li>
          <li><a class="getstarted scrollto" data-bs-toggle="modal" data-bs-target="#exampleModal2">Report</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->
  <div id="preloader"></div>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add Vehicle</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row" style="margin-bottom: 10px;">
              <div class="col-3">
                <select id="year" class="form-select" aria-label="Default select example">
                  <option selected>Select Year</option>
                  <option value="2024">2024</option>
                  <option value="2023">2023</option>
                  <option value="2022">2022</option>
                  <option value="2021">2021</option>
                  <option value="2020">2020</option>
                  <option value="2019">2019</option>
                  <option value="2018">2018</option>
                  <option value="2017">2017</option>
                  <option value="2016">2016</option>
                  <option value="2015">2015</option>
                  <option value="2014">2014</option>
                  <option value="2013">2013</option>
                  <option value="2012">2012</option>
                </select>
              </div>
              <div class="col-3">
                <select id="make" class="form-select" aria-label="Default select example">
                  <option selected>Select Car Make</option>
                </select>
              </div>
              <div class="col-3">
                <select id="model" class="form-select" aria-label="Default select example">
                  <option selected>Select Model</option>
                </select>
              </div>
              <!-- <div class="col-3">
                <select id="type" class="form-select" aria-label="Default select example">
                  <option selected disabled hidden>Select Type</option>
                  <option value="19.9">1.3 M/T (19.9km/L)</option>
                  <option value="1.3 XE CVT">1.3 XE CVT</option>
                  <option value="1.6 E M/T">1.6 E M/T</option>
                  <option value="1.6 G A/T">1.6 G A/T</option>
                  <option value="1.3 E A/T">1.3 E A/T</option>
                  <option value="1.5 G A/T">1.5 G A/T</option>
                </select>
              </div> -->
            </div>

            <ul class="nav nav-tabs" id="myTab" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Using Distance</button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Using Odometer Reading</button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="map-tab" data-bs-toggle="tab" data-bs-target="#map" type="button" role="tab" aria-controls="map" aria-selected="false">Using Map Locations</button>
              </li>
            </ul>
            <div class="tab-content" id="myTabContent">
              <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                <div class="row" style="margin-bottom: 10px;">
                  <h4 style="margin-top: 10px;">Calculate Using Distance Traveled</h4>
                </div>
                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Trip Distance:</p>
                  </div>
                  <div class="col-2">
                    <input id="trip" type="text" class="form-control">
                  </div>
                  <div class="col-3">
                    <select id="make" class="form-select" aria-label="Default select example">
                      <option value="kilometers" selected >Kilometers</option>
                    </select>
                  </div>
                </div>

                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Fuel Consumed (L):</p>
                  </div>
                  <div class="col-2">
                    <input id="fuel" type="text" readonly class="form-control">
                  </div>
                </div>

                <div class="row" style="margin-bottom:10px;">
                  <div class="col-2">
                    <button id="calculate" type="button" class="btn btn-success">Calculate</button>
                  </div>
                </div>

              </div>
              <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                <div class="row" style="margin-bottom: 10px;">
                  <h4 style="margin-top: 10px;">Calculate Using Current and Previous Odometer Readings</h4>
                </div>
                <div class="row" style="margin-bottom: 10px; font-weight:700 ;">
                  <p>Odometer</p>
                </div>

                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Previous Reading:</p>
                  </div>
                  <div class="col-2">
                    <input type="text" id="prev" class="form-control">
                  </div>
                  <div class="col-3">
                    <select id="make" class="form-select" aria-label="Default select example">
                      <option value="kilometers" selected >Kilometers</option>
                    </select>
                  </div>
                </div>

                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Current Reading:</p>
                  </div>
                  <div class="col-2">
                    <input type="text" id="current" class="form-control">
                  </div>
                  <div class="col-3">
                    <select id="make" class="form-select" aria-label="Default select example">
                      <option value="kilometers" selected >Kilometers</option>
                    </select>
                  </div>
                </div>
                
                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Fuel Consumed (L):</p>
                  </div>
                  <div class="col-2">
                    <input id="fuel2" type="text" readonly class="form-control">
                  </div>
                </div>

                <div class="row" style="margin-bottom:10px;">
                  <div class="col-2">
                    <button id="calculate2" type="button" class="btn btn-success">Calculate</button>
                  </div>
                </div>

              </div>

              <div class="tab-pane fade" id="map" role="tabpanel" aria-labelledby="map-tab">
                <div class="row" style="margin-bottom: 10px;">
                  <h4 style="margin-top: 10px;">Calculate Using Start and End Location</h4>
                </div>

                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Start Location:</p>
                  </div>
                  <div class="col-10">
                    <input type="text" id="start_loc" class="form-control">
                  </div>
                </div>

                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>End Location:</p>
                  </div>
                  <div class="col-10">
                    <input type="text" id="end_loc" class="form-control">
                  </div>
                </div>

                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Start LatLon:</p>
                  </div>
                  <div class="col-10">
                    <input type="text" id="start_latlon" class="form-control">
                  </div>
                </div>

                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>End LatLon:</p>
                  </div>
                  <div class="col-10">
                    <input type="text" id="end_latlon" class="form-control">
                  </div>
                </div>
                
                <div class="row" style="margin-bottom: 10px;">
                  <div class="col-2">
                    <p>Fuel Consumed (L):</p>
                  </div>
                  <div class="col-2">
                    <input id="fuel3" type="text" readonly class="form-control">
                  </div>
                </div>

                <div class="row" style="margin-bottom:10px;">
                  <div class="col-2">
                    <button id="calculate3" type="button" class="btn btn-success">Calculate</button>
                  </div>
                </div>

                <div class="row" style="margin-bottom:10px;">
                  <div class="col-4">
                    <div id="map-directions"></div>
                  </div>
                  <div class="col-8">
                    <div id="map-main"></div>
                  </div>
                </div>

              </div>
            </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModal2Label" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModal2Label">Report</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
              <div class="row" style="margin-bottom: 10px;">
                <div class="col-2">
                  <button type="button" class="btn btn-success" data-bs-dismiss="modal">Upload CSV</button>
                </div>
                
              </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

            </div>
          </div>
      </div>
    </div>
  </div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOosgtkGRar0pCV8m9s9jo2DsVQaCs0jI&libraries=places"></script>
  <script>
    $(document).ready( function(){
      var values = [ 
        {
          '2013' : ['Vios'],
          '2014' : ['Vios'],
          '2015' : ['Altis','Vios'],
          '2016' : ['Altis','Vios'],
          '2017' : ['Altis','Vios'],
          '2018' : ['Altis','Vios'],
          '2019' : ['Altis','Vios'],
          '2020' : ['Altis','Vios'],
        }
      ];

      var vios_year = ['2013','2014'];
      var vios_latest_year = ['2021','2022','2023','2024']
      var vios_altis_year = ['2015','2016','2017','2018','2019','2020'];

      $('#year').on('change', function(){
        var value = $(this).val();
          clearOptionsExceptFirst('make');
          clearOptionsExceptFirst('model');
          if(vios_year.includes(value)){
            addOption('toyota', 'Toyota', 'make');
          }else if(vios_altis_year.includes(value)){
            addOption('toyota', 'Toyota', 'make');
          }else if(vios_latest_year.includes(value)){
            addOption('toyota', 'Toyota', 'make');
          }else{
            clearOptionsExceptFirst('model');
            clearOptionsExceptFirst('make');
          }
      });

      $('#make').on('change', function(){
        var year = $('#year').val();
        var val = $(this).val();
        clearOptionsExceptFirst('model');
        if(vios_year.includes(year) && val.trim() == 'toyota'){
          addOption('vios', 'Vios (15km/L)', 'model');
        }
        else if(vios_latest_year.includes(year) && val.trim() == 'toyota'){
          addOption('vios', 'Vios (10km/L)', 'model');
        }
        else if(vios_altis_year.includes(year) && val.trim() == 'toyota'){
          addOption('vios', 'Vios (15km/L)', 'model');
          addOption('altis', 'Altis (13km/L)', 'model');
        }else{
          clearOptionsExceptFirst('model');
        }
      });

      $('#calculate').on('click', function(){
        var model = $('#model').val();
        var trip = $('#trip').val();
        var year = $('#year').val();
        var fuel_consumed;

        if(model.trim() == 'altis'){
          fuel_consumed = parseFloat(trip) / 13;
        }else if(model.trim() == 'vios'){
          if(vios_latest_year.includes(year)){
            fuel_consumed = parseFloat(trip) / 10;
          }else{
            fuel_consumed = parseFloat(trip) / 15;
          }
        }else{
          fuel_consumed = 0.00;
        }
        $('#fuel').val(fuel_consumed.toFixed(2));

        $.ajax({
            url: 'https://api.example.com/data', // URL of the data source
            type: 'GET', // Method type GET/POST/PUT/DELETE, etc.
            dataType: 'json', // Type of data expected back from the server
            success: function(response) {
                // Handle the success case
                $('#dataDisplay').html('<pre>' + JSON.stringify(response, null, 2) + '</pre>');
            },
            error: function(xhr, status, error) {
                // Handle errors here
                $('#dataDisplay').html("Error: " + error);
            }
        });

      });

      $('#calculate2').on('click', function(){
        var prev = $('#prev').val();
        var current = $('#current').val();
        var year = $('#year').val();
        var trip = current - prev;
        var model = $('#model').val();
        var fuel_consumed;

        if(model.trim() == 'altis'){
          fuel_consumed = parseFloat(trip) / 13;
        }else if(model.trim() == 'vios'){
          if(vios_latest_year.includes(year)){
            fuel_consumed = parseFloat(trip) / 10;
          }else{
            fuel_consumed = parseFloat(trip) / 15;
          }
        }else{
          fuel_consumed = 0.00;
        }

        $('#fuel2').val(fuel_consumed.toFixed(2));
      });

      initAutocomplete();

    });

    function addOption(value, text, id) {
        $('#'+id).append($('<option>', {
            value: value,
            text: text
        }));
    }

    function clearOptionsExceptFirst(id) {
        $('#'+id+' option:not(:first)').remove(); // Removes all except the first option
    }

    function initAutocomplete() {

      var start_loc = new google.maps.places.Autocomplete(
        $('#start_loc')[0], {types: ['geocode']});
      start_loc.setFields(['address_components', 'geometry', 'icon', 'name']);

      start_loc.addListener('place_changed', function() {
        var place = start_loc.getPlace();
      });

      var end_loc = new google.maps.places.Autocomplete(
        $('#end_loc')[0], {types: ['geocode']});
      end_loc.setFields(['address_components', 'geometry', 'icon', 'name']);

      end_loc.addListener('place_changed', function() {
        var place = end_loc.getPlace();
      });

      

      $('#calculate3').on('click', function(){
        var start_latlon = $("#start_latlon").val();
        var end_latlon = $("#end_latlon").val();
        const parts_start_latlon = start_latlon.split(",");
        const parts_end_latlon = end_latlon.split(",");
        console.log(parts_start_latlon);
        console.log(parts_end_latlon);

        const myLatLng_start = {lat: Number(parts_start_latlon[0]), lng: Number(parts_start_latlon[1])};
        console.log(myLatLng_start);
        const myLatLng_end = {lat: Number(parts_end_latlon[0]), lng: Number(parts_end_latlon[1])};
        console.log(myLatLng_end);

        var map = new google.maps.Map($('#map-main')[0], {
            center: {lat: 13, lng: 122},
            zoom: 7
        });
        var start_loc_marker = new google.maps.Marker({
            map: map,
            // Other properties can be set similarly to the old Marker
            anchorPoint: new google.maps.Point(0, -29)
        });
        start_loc_marker.setVisible(false);
        

        var start_loc_place = start_loc.getPlace();
        if (!start_loc_place || !start_loc_place.geometry) {
          start_loc_marker.setPosition(myLatLng_start);
          var start_loc_marker_lat = Number(parts_start_latlon[0]);
          var start_loc_marker_lng = Number(parts_start_latlon[1]);
        }else{
          start_loc_marker.setPosition(start_loc_place.geometry.location);
          var start_loc_marker_lat = start_loc_place.geometry.location.lat();
          var start_loc_marker_lng = start_loc_place.geometry.location.lng();
        }

        // 
        var end_loc_marker = new google.maps.Marker({
            map: map,
            // Other properties can be set similarly to the old Marker
            anchorPoint: new google.maps.Point(0, -29)
        });
        end_loc_marker.setVisible(false);
        

        var end_loc_place = end_loc.getPlace();
        if (!end_loc_place || !end_loc_place.geometry) {
          end_loc_marker.setPosition(myLatLng_end);
          var end_loc_marker_lat = Number(parts_end_latlon[0]);
          var end_loc_marker_lng = Number(parts_end_latlon[1]);
        }else{
          end_loc_marker.setPosition(end_loc_place.geometry.location);
          var end_loc_marker_lat = end_loc_place.geometry.location.lat();
          var end_loc_marker_lng = end_loc_place.geometry.location.lng(); 
        }
        //end_loc_marker.setVisible(true);

        

        const directionsService2 = new google.maps.DirectionsService();
        const directionsRenderer = new google.maps.DirectionsRenderer();
        directionsRenderer.setMap(map);

        calculateAndDisplayRoute(directionsService2, directionsRenderer,start_loc_marker_lat,start_loc_marker_lng,end_loc_marker_lat,end_loc_marker_lng);
 
      });

    }

    function calculateAndDisplayRoute(directionsService, directionsRenderer,l1,lo1,l2,lo2) {
      $('#map-directions').empty();

      directionsService
      .route({
        origin: l1+','+lo1,
        destination: l2+','+lo2,
        // Note that Javascript allows us to access the constant
        // using square brackets and a string value as its
        // "property."
        travelMode: "DRIVING",
      })
      .then((response) => {
        directionsRenderer.setDirections(response);
        directionsRenderer.setPanel(document.getElementById("map-directions"));
        directionsRenderer.setOptions({
          preserveViewport: true
        });
        const dist = response.routes[0].legs[0].distance.text;
        const dur = response.routes[0].legs[0].duration.text;

        var model = $('#model').val();
        var year = $('#year').val();
        var vios_year = ['2013','2014'];
        var vios_latest_year = ['2021','2022','2023','2024']
        var vios_altis_year = ['2015','2016','2017','2018','2019','2020'];
        var fuel_consumed;

        const route = response.routes[0];
        let totalDistance = 0;
        for (let i = 0; i < route.legs.length; i++) {
            totalDistance += route.legs[i].distance.value; // Distance in meters
        }
        totalDistance = (totalDistance / 1000);
        
        if(model.trim() == 'altis'){
          fuel_consumed = parseFloat(totalDistance) / 13;
        }else if(model.trim() == 'vios'){
          if(vios_latest_year.includes(year)){
            fuel_consumed = parseFloat(totalDistance) / 10;
          }else{
            fuel_consumed = parseFloat(totalDistance) / 15;
          }
        }else{
          fuel_consumed = 0.00;
        }

        $('#fuel3').val(fuel_consumed.toFixed(2));
  
      })
      .catch((e) => window.alert("Directions request failed due to " + e));
      
    }
      
  </script>

</body>

</html>